<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>Chrome Translation API è¨€èªå¯¾å¿œãƒãƒˆãƒªãƒƒã‚¯ã‚¹</title>
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .status {
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
            font-weight: bold;
        }
        .status.checking {
            background: #fff3cd;
            color: #856404;
        }
        .status.complete {
            background: #d4edda;
            color: #155724;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 12px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        th {
            background: #f8f9fa;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        th.source {
            background: #e3f2fd;
        }
        td.source {
            background: #f5f5f5;
            font-weight: bold;
        }
        .available {
            background: #c8e6c9;
            color: #2e7d32;
            font-weight: bold;
        }
        .downloadable {
            background: #fff9c4;
            color: #f57f17;
        }
        .unavailable {
            background: #ffebee;
            color: #c62828;
        }
        .same {
            background: #e0e0e0;
            color: #757575;
        }
        .legend {
            display: flex;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .legend-box {
            width: 20px;
            height: 20px;
            border: 1px solid #ccc;
        }
        #progress {
            margin: 20px 0;
        }
        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        .summary {
            background: #e8f5e9;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        button {
            background: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #45a049;
        }
    </style>
    <script src="chrome_translator_v2.js"></script>
</head>
<body>
    <div class="container">
        <h1>ğŸŒ Chrome Translation API è¨€èªå¯¾å¿œãƒãƒˆãƒªãƒƒã‚¯ã‚¹</h1>
        <p style="text-align: center;">éŸ³å£°èªè­˜å­—å¹•ã¡ã‚ƒã‚“ã§ä½¿ç”¨å¯èƒ½ãªè¨€èªãƒšã‚¢ã‚’ç·ãƒã‚§ãƒƒã‚¯</p>
        
        <div id="status" class="status checking">
            åˆæœŸåŒ–ä¸­...
        </div>
        
        <div>
            <button onclick="checkAllLanguages()">å…¨è¨€èªãƒšã‚¢ã‚’ãƒã‚§ãƒƒã‚¯</button>
            <button onclick="checkFromJapanese()">æ—¥æœ¬èªã‹ã‚‰ã®ç¿»è¨³ã®ã¿ãƒã‚§ãƒƒã‚¯</button>
            <button onclick="exportResults()">çµæœã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
        </div>
        
        <div id="progress" style="display: none;">
            <div class="progress-bar">
                <div id="progress-fill" class="progress-fill">0%</div>
            </div>
            <p id="progress-text" style="text-align: center;"></p>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-box available"></div>
                <span>å³åº§ã«åˆ©ç”¨å¯èƒ½ (available)</span>
            </div>
            <div class="legend-item">
                <div class="legend-box downloadable"></div>
                <span>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¾Œåˆ©ç”¨å¯èƒ½ (downloadable)</span>
            </div>
            <div class="legend-item">
                <div class="legend-box unavailable"></div>
                <span>åˆ©ç”¨ä¸å¯ (no)</span>
            </div>
            <div class="legend-item">
                <div class="legend-box same"></div>
                <span>åŒä¸€è¨€èª</span>
            </div>
        </div>
        
        <div id="summary" class="summary" style="display: none;"></div>
        
        <div id="results"></div>
    </div>
    
    <script>
        // éŸ³å£°èªè­˜å­—å¹•ã¡ã‚ƒã‚“ãŒã‚µãƒãƒ¼ãƒˆã™ã‚‹è¨€èªãƒªã‚¹ãƒˆ
        const jimakuChanLanguages = [
            { code: 'ja', name: 'æ—¥æœ¬èª', chromeCode: 'ja' },
            { code: 'en', name: 'è‹±èª', chromeCode: 'en' },
            { code: 'ko', name: 'éŸ“å›½èª', chromeCode: 'ko' },
            { code: 'zh-CN', name: 'ä¸­å›½èª(ç°¡)', chromeCode: 'zh' },
            { code: 'zh-TW', name: 'ä¸­å›½èª(ç¹)', chromeCode: 'zh-Hant' },
            { code: 'zh-HK', name: 'é¦™æ¸¯èª', chromeCode: 'zh-Hant' },
            { code: 'fr', name: 'ãƒ•ãƒ©ãƒ³ã‚¹èª', chromeCode: 'fr' },
            { code: 'it', name: 'ã‚¤ã‚¿ãƒªã‚¢èª', chromeCode: 'it' },
            { code: 'de', name: 'ãƒ‰ã‚¤ãƒ„èª', chromeCode: 'de' },
            { code: 'tr', name: 'ãƒˆãƒ«ã‚³èª', chromeCode: 'tr' },
            { code: 'sv', name: 'ã‚¹ã‚¦ã‚§ãƒ¼ãƒ‡ãƒ³èª', chromeCode: 'sv' },
            { code: 'pl', name: 'ãƒãƒ¼ãƒ©ãƒ³ãƒ‰èª', chromeCode: 'pl' },
            { code: 'uk', name: 'ã‚¦ã‚¯ãƒ©ã‚¤ãƒŠèª', chromeCode: 'uk' },
            { code: 'ru', name: 'ãƒ­ã‚·ã‚¢èª', chromeCode: 'ru' },
            { code: 'es', name: 'ã‚¹ãƒšã‚¤ãƒ³èª', chromeCode: 'es' },
            { code: 'pt', name: 'ãƒãƒ«ãƒˆã‚¬ãƒ«èª', chromeCode: 'pt' },
            { code: 'nl', name: 'ã‚ªãƒ©ãƒ³ãƒ€èª', chromeCode: 'nl' },
            { code: 'id', name: 'ã‚¤ãƒ³ãƒ‰ãƒã‚·ã‚¢èª', chromeCode: 'id' },
            { code: 'vi', name: 'ãƒ™ãƒˆãƒŠãƒ èª', chromeCode: 'vi' },
            { code: 'th', name: 'ã‚¿ã‚¤èª', chromeCode: 'th' },
            { code: 'ar', name: 'ã‚¢ãƒ©ãƒ“ã‚¢èª', chromeCode: 'ar' },
            { code: 'so', name: 'ã‚½ãƒãƒªèª', chromeCode: 'so' },
            { code: 'el', name: 'ã‚®ãƒªã‚·ãƒ£èª', chromeCode: 'el' }
        ];
        
        let results = {};
        
        async function initializeAPI() {
            const statusEl = document.getElementById('status');
            
            if (!('Translator' in self)) {
                statusEl.textContent = 'âŒ Chrome Translation APIã¯åˆ©ç”¨ã§ãã¾ã›ã‚“';
                statusEl.className = 'status error';
                return false;
            }
            
            if (window.chromeTranslator) {
                await window.chromeTranslator.checkAvailability();
                if (window.chromeTranslator.isAvailable) {
                    statusEl.textContent = 'âœ… Chrome Translation APIæº–å‚™å®Œäº†';
                    statusEl.className = 'status complete';
                    return true;
                }
            }
            
            statusEl.textContent = 'âŒ Chrome Translation APIã®åˆæœŸåŒ–ã«å¤±æ•—';
            statusEl.className = 'status error';
            return false;
        }
        
        async function checkLanguagePair(sourceLang, targetLang) {
            try {
                const availability = await Translator.availability({
                    sourceLanguage: sourceLang.chromeCode,
                    targetLanguage: targetLang.chromeCode
                });
                return availability;
            } catch (error) {
                console.error(`ã‚¨ãƒ©ãƒ¼: ${sourceLang.code} â†’ ${targetLang.code}`, error);
                return 'error';
            }
        }
        
        async function checkAllLanguages() {
            const apiReady = await initializeAPI();
            if (!apiReady) return;
            
            const progressEl = document.getElementById('progress');
            const progressFillEl = document.getElementById('progress-fill');
            const progressTextEl = document.getElementById('progress-text');
            const statusEl = document.getElementById('status');
            
            progressEl.style.display = 'block';
            statusEl.textContent = 'ãƒã‚§ãƒƒã‚¯ä¸­...';
            statusEl.className = 'status checking';
            
            results = {};
            const total = jimakuChanLanguages.length * jimakuChanLanguages.length;
            let current = 0;
            
            // å„è¨€èªãƒšã‚¢ã‚’ãƒã‚§ãƒƒã‚¯
            for (const sourceLang of jimakuChanLanguages) {
                results[sourceLang.code] = {};
                
                for (const targetLang of jimakuChanLanguages) {
                    current++;
                    const progress = Math.round((current / total) * 100);
                    progressFillEl.style.width = progress + '%';
                    progressFillEl.textContent = progress + '%';
                    progressTextEl.textContent = `ãƒã‚§ãƒƒã‚¯ä¸­: ${sourceLang.name} â†’ ${targetLang.name}`;
                    
                    if (sourceLang.code === targetLang.code) {
                        results[sourceLang.code][targetLang.code] = 'same';
                    } else {
                        const availability = await checkLanguagePair(sourceLang, targetLang);
                        results[sourceLang.code][targetLang.code] = availability;
                        
                        // ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’é¿ã‘ã‚‹ãŸã‚å°‘ã—å¾…æ©Ÿ
                        await new Promise(resolve => setTimeout(resolve, 50));
                    }
                }
            }
            
            statusEl.textContent = 'âœ… ãƒã‚§ãƒƒã‚¯å®Œäº†';
            statusEl.className = 'status complete';
            displayResults();
            showSummary();
        }
        
        async function checkFromJapanese() {
            const apiReady = await initializeAPI();
            if (!apiReady) return;
            
            const progressEl = document.getElementById('progress');
            const progressFillEl = document.getElementById('progress-fill');
            const progressTextEl = document.getElementById('progress-text');
            const statusEl = document.getElementById('status');
            
            progressEl.style.display = 'block';
            statusEl.textContent = 'ãƒã‚§ãƒƒã‚¯ä¸­...';
            statusEl.className = 'status checking';
            
            results = { 'ja': {} };
            const sourceLang = jimakuChanLanguages.find(l => l.code === 'ja');
            const total = jimakuChanLanguages.length;
            let current = 0;
            
            for (const targetLang of jimakuChanLanguages) {
                current++;
                const progress = Math.round((current / total) * 100);
                progressFillEl.style.width = progress + '%';
                progressFillEl.textContent = progress + '%';
                progressTextEl.textContent = `ãƒã‚§ãƒƒã‚¯ä¸­: æ—¥æœ¬èª â†’ ${targetLang.name}`;
                
                if (targetLang.code === 'ja') {
                    results['ja'][targetLang.code] = 'same';
                } else {
                    const availability = await checkLanguagePair(sourceLang, targetLang);
                    results['ja'][targetLang.code] = availability;
                    
                    await new Promise(resolve => setTimeout(resolve, 50));
                }
            }
            
            statusEl.textContent = 'âœ… ãƒã‚§ãƒƒã‚¯å®Œäº†';
            statusEl.className = 'status complete';
            displayResults();
            showSummary();
        }
        
        function displayResults() {
            const resultsEl = document.getElementById('results');
            
            let html = '<h2>è¨€èªå¯¾å¿œè¡¨</h2>';
            html += '<div style="overflow-x: auto;">';
            html += '<table>';
            
            // ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œ
            html += '<tr>';
            html += '<th>ã‚½ãƒ¼ã‚¹ï¼¼ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ</th>';
            for (const lang of jimakuChanLanguages) {
                html += `<th>${lang.name}<br><small>${lang.code}</small></th>`;
            }
            html += '</tr>';
            
            // ãƒ‡ãƒ¼ã‚¿è¡Œ
            for (const sourceLang of jimakuChanLanguages) {
                if (!results[sourceLang.code]) continue;
                
                html += '<tr>';
                html += `<td class="source">${sourceLang.name}<br><small>${sourceLang.code}</small></td>`;
                
                for (const targetLang of jimakuChanLanguages) {
                    const result = results[sourceLang.code][targetLang.code];
                    let className = '';
                    let text = '';
                    
                    if (result === 'same') {
                        className = 'same';
                        text = 'ï¼';
                    } else if (result === 'available') {
                        className = 'available';
                        text = 'âœ…';
                    } else if (result === 'downloadable') {
                        className = 'downloadable';
                        text = 'â¬‡ï¸';
                    } else {
                        className = 'unavailable';
                        text = 'âŒ';
                    }
                    
                    html += `<td class="${className}">${text}</td>`;
                }
                html += '</tr>';
            }
            
            html += '</table>';
            html += '</div>';
            
            resultsEl.innerHTML = html;
        }
        
        function showSummary() {
            const summaryEl = document.getElementById('summary');
            
            let availableCount = 0;
            let downloadableCount = 0;
            let unavailableCount = 0;
            let totalPairs = 0;
            
            for (const source in results) {
                for (const target in results[source]) {
                    if (results[source][target] !== 'same') {
                        totalPairs++;
                        if (results[source][target] === 'available') availableCount++;
                        else if (results[source][target] === 'downloadable') downloadableCount++;
                        else unavailableCount++;
                    }
                }
            }
            
            let html = '<h3>ğŸ“Š çµ±è¨ˆæƒ…å ±</h3>';
            html += `<p>ãƒã‚§ãƒƒã‚¯ã—ãŸè¨€èªãƒšã‚¢æ•°: ${totalPairs}</p>`;
            html += `<p>âœ… å³åº§ã«åˆ©ç”¨å¯èƒ½: ${availableCount} (${Math.round(availableCount/totalPairs*100)}%)</p>`;
            html += `<p>â¬‡ï¸ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¾Œåˆ©ç”¨å¯èƒ½: ${downloadableCount} (${Math.round(downloadableCount/totalPairs*100)}%)</p>`;
            html += `<p>âŒ åˆ©ç”¨ä¸å¯: ${unavailableCount} (${Math.round(unavailableCount/totalPairs*100)}%)</p>`;
            
            // äººæ°—ã®è¨€èªãƒšã‚¢ã®çŠ¶æ³
            const popularPairs = [
                { from: 'ja', to: 'en', name: 'æ—¥æœ¬èªâ†’è‹±èª' },
                { from: 'ja', to: 'ko', name: 'æ—¥æœ¬èªâ†’éŸ“å›½èª' },
                { from: 'ja', to: 'zh-CN', name: 'æ—¥æœ¬èªâ†’ä¸­å›½èª(ç°¡)' },
                { from: 'en', to: 'ja', name: 'è‹±èªâ†’æ—¥æœ¬èª' },
                { from: 'ko', to: 'ja', name: 'éŸ“å›½èªâ†’æ—¥æœ¬èª' }
            ];
            
            html += '<h4>ä¸»è¦ãªè¨€èªãƒšã‚¢ã®çŠ¶æ³:</h4>';
            html += '<ul>';
            for (const pair of popularPairs) {
                if (results[pair.from] && results[pair.from][pair.to]) {
                    const status = results[pair.from][pair.to];
                    let statusText = '';
                    if (status === 'available') statusText = 'âœ… å³åº§ã«åˆ©ç”¨å¯èƒ½';
                    else if (status === 'downloadable') statusText = 'â¬‡ï¸ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¾Œåˆ©ç”¨å¯èƒ½';
                    else statusText = 'âŒ åˆ©ç”¨ä¸å¯';
                    
                    html += `<li>${pair.name}: ${statusText}</li>`;
                }
            }
            html += '</ul>';
            
            summaryEl.innerHTML = html;
            summaryEl.style.display = 'block';
        }
        
        function exportResults() {
            if (Object.keys(results).length === 0) {
                alert('ã¾ãšè¨€èªãƒšã‚¢ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„');
                return;
            }
            
            let csv = 'ã‚½ãƒ¼ã‚¹è¨€èª,ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè¨€èª,çŠ¶æ…‹\n';
            
            for (const source in results) {
                for (const target in results[source]) {
                    const sourceName = jimakuChanLanguages.find(l => l.code === source)?.name || source;
                    const targetName = jimakuChanLanguages.find(l => l.code === target)?.name || target;
                    csv += `${sourceName},${targetName},${results[source][target]}\n`;
                }
            }
            
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'chrome_translation_languages.csv';
            link.click();
        }
        
        // åˆæœŸåŒ–
        window.addEventListener('load', () => {
            initializeAPI();
        });
    </script>
</body>
</html>